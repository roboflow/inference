export PROJECT=roboflow-staging
export MODEL_CACHE_DIR=/rfcache
export NUM_WORKERS=1
export LOG_LEVEL=INFO
export CORRELATION_ID_LOG_KEY=request_id

export MODELS_CACHE_AUTH_ENABLED=True
export INTERNAL_WEIGHTS_URL_SUFFIX=serverless
export MODELS_CACHE_AUTH_CACHE_TTL=900
export MODELS_CACHE_AUTH_CACHE_MAX_SIZE=1000
export LAMBDA=False
export GCP_SERVERLESS=True
export DEVICE_ID=RoboflowHostedInference

export DISABLE_VERSION_CHECK=True
export METRICS_ENABLED=False
export VERSION_CHECK_MODE=continuous
export ENABLE_STREAM_API=False
export STREAM_API_PRELOADED_PROCESSES=0
export ENABLE_PROMETHEUS=False
export GET_MODEL_REGISTRY_ENABLED=False
export ACTIVE_LEARNING_ENABLED=False
export DISK_CACHE_CLEANUP=False
export DISABLE_INFERENCE_CACHE=False
export MAX_ACTIVE_MODELS=50
export ENABLE_DASHBOARD=False
export MEMORY_FREE_THRESHOLD=0.30

export WORKFLOWS_STEP_EXECUTION_MODE=local
export WORKFLOWS_MAX_CONCURRENT_STEPS=4
export ALLOW_CUSTOM_PYTHON_EXECUTION_IN_WORKFLOWS=False
export WORKFLOWS_CUSTOM_PYTHON_EXECUTION_MODE=modal
export ALLOW_WORKFLOW_BLOCKS_ACCESSING_ENVIRONMENTAL_VARIABLES=False
export DISABLE_WORKFLOW_ENDPOINTS=False

export API_LOGGING_ENABLED=True
export ENABLE_IN_MEMORY_LOGS=False

export LMM_ENABLED=False
export CORE_MODEL_SAM2_ENABLED=True
export CORE_MODEL_OWLV2_ENABLED=True
export CORE_MODEL_PE_ENABLED=False
export CORE_MODELS_ENABLED=True
export SMOLVLM2_ENABLED=False
export QWEN_2_5_ENABLED=False
export DEPTH_ESTIMATION_ENABLED=False
export MOONDREAM2_ENABLED=False
export CORE_MODEL_SAM3_ENABLED=True

export HF_HOME=/rfcache/hugging_face
export TORCHINDUCTOR_CACHE_DIR=/tmp/torch_compile_cache

export ROBOFLOW_INTERNAL_SERVICE_NAME=serverless-inference
export ROBOFLOW_INTERNAL_SERVICE_SECRET=032C4245-2346-4ED7-9D9A-A8B5C3B9E422
export ROBOFLOW_SERVICE_SECRET=390f3e3d-c84d-42a6-9200-a9d4c07163ec

export MODAL_WORKSPACE_NAME=roboflow

export WEBRTC_MODAL_RTSP_PLACEHOLDER=rtsp://demo.roboflow.com:8554
export WEBRTC_MODAL_RTSP_PLACEHOLDER_URL=rtsp://34.56.16.251:8554/mystream1
export WEBRTC_MODAL_FUNCTION_TIME_LIMIT=120
export WEBRTC_MODAL_FUNCTION_ENABLE_MEMORY_SNAPSHOT=True
export WEBRTC_MODAL_FUNCTION_SCALEDOWN_WINDOW=15
export WEBRTC_MODAL_FUNCTION_MIN_CONTAINERS=0
export WEBRTC_MODAL_FUNCTION_BUFFER_CONTAINERS=0
export WEBRTC_WORKER_ENABLED=True
export WEBRTC_MODAL_FUNCTION_GPU=T4
export WEBRTC_MODAL_RESPONSE_TIMEOUT=120
export WEBRTC_MODAL_SHUTDOWN_RESERVE=10

export WEBRTC_MODAL_MIN_CPU_CORES=2
export WEBRTC_MODAL_MIN_RAM_MB=4096

export WEBRTC_MODAL_PRELOAD_HF_IDS=google/owlv2-large-patch14-ensemble
export WEBRTC_MODAL_PRELOAD_MODELS="sam3/sam3_final"

export WEBRTC_MODAL_APP_NAME=inference-webrtc-crusoe-staging
export WEBRTC_MODAL_MODELS_PRELOAD_API_KEY=dAIIk1SGTh4FD5nMFq31

# tag
export WEBRTC_MODAL_IMAGE_NAME=roboflow/roboflow-inference-server-gpu
export WEBRTC_MODAL_IMAGE_TAG=0.62.3-rc3
# rodrigo
export WEBRTC_MODAL_TOKEN_ID=ak-D4VmVlpD5W90w1XjaunqD2
export WEBRTC_MODAL_TOKEN_SECRET=as-HaPN8J5oHgbnF8uV20ZGFk


source /Users/digao/dev/inference/.venv/bin/activate
API_KEY=dAIIk1SGTh4FD5nMFq31 python /Users/digao/dev/inference/rodrigo/deploy_modal.py
