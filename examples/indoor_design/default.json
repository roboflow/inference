{
  "version": "1.0",
  "inputs": [
    {
      "type": "WorkflowImage",
      "name": "image"
    },
    {
      "type": "WorkflowParameter",
      "name": "object_prompt",
      "default_value": ["object"]
    },
    {
      "type": "WorkflowParameter",
      "name": "output_dir",
      "default_value": "./output"
    }
  ],
  "steps": [
    {
      "type": "roboflow_core/sam3@v1",
      "name": "sam3",
      "images": "$inputs.image",
      "class_names": "$inputs.object_prompt",
      "threshold": 0.5
    },
    {
      "type": "roboflow_core/property_definition@v1",
      "name": "format_sam3",
      "data": "$steps.sam3.predictions",
      "operations": [
        {"type": "DetectionsToDictionary"},
        {"type": "ConvertDictionaryToJSON"}
      ]
    },
    {
      "type": "roboflow_core/local_file_sink@v1",
      "name": "save_sam3",
      "content": "$steps.format_sam3.output",
      "file_type": "json",
      "output_mode": "separate_files",
      "target_directory": "$inputs.output_dir",
      "file_name_prefix": "step_sam3"
    },
    {
      "type": "roboflow_core/segment_anything3_3d_objects@v1",
      "name": "sam3_3d",
      "images": "$inputs.image",
      "mask_input": "$steps.sam3.predictions"
    }
  ],
  "outputs": [
    {
      "type": "JsonField",
      "name": "mesh_glb",
      "coordinates_system": "own",
      "selector": "$steps.sam3_3d.mesh_glb"
    },
    {
      "type": "JsonField",
      "name": "gaussian_ply",
      "coordinates_system": "own",
      "selector": "$steps.sam3_3d.gaussian_ply"
    },
    {
      "type": "JsonField",
      "name": "objects",
      "coordinates_system": "own",
      "selector": "$steps.sam3_3d.objects"
    },
    {
      "type": "JsonField",
      "name": "inference_time",
      "coordinates_system": "own",
      "selector": "$steps.sam3_3d.inference_time"
    }
  ]
}
