defaults:
  - /data/dataset/tdfy/trellis500k/preprocessor@latent_loader_dataset.preprocessor: val_keep_bg_w_ptmap_normalized


_target_: lidra.data.dataset.tdfy.r3.anything_dataset.AnythingDataset

dataset:
  _target_: lidra.data.dataset.tdfy.r3.dataset.R3Dataset
  data_dir: "${cluster.path.datasets}/catc_vlmsearch/rank4o_v08"


# Latent loader configuration
latent_loader_dataset:
  _target_: lidra.data.dataset.tdfy.trellis.dataset.PerSubsetDataset
  path: "${cluster.path.datasets}/catc_vlmsearch/rank4o_v08"
  split: "val"
  metadata_fname: "metadata_test_epickitchen.csv"
  latent_dir: "ss_latents/trellis-ss-vae-trial1-lambda1e-3-8x8"
  pose_loader: 
    _target_: lidra.data.dataset.tdfy.trellis.pose_loader.dummy_VLMranked_identity_pose
    _partial_: true
  metadata_filter:
    _target_: lidra.data.dataset.tdfy.metadata_filter.custom_metadata_filter
    filter_funcs:
      - _target_: lidra.data.dataset.tdfy.metadata_filter.data_query_filter
        query: "ss_latent_ss_enc_conv3d_16l8_fp16==True and pointmap_exists==True"
  latent_loader: 
    _target_: lidra.data.dataset.tdfy.trellis.latent_loader.load_structure_latents
    _partial_: true
  return_pointmap: true
  pointmap_loader:
    _target_: lidra.data.dataset.tdfy.trellis.pose_loader.R3.load_pointmap
    _partial_: True
    pointcloud_directory: "/checkpoint/3dfy/shared/r3_data/pointmaps/catc_v08_moge"