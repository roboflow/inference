(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{5208:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(5155),a=s(2115);let l=["/workflows/run","/inference_pipelines/","/infer/"];var n=s(5803),c=s.n(n),i=s(9300),o=s.n(i);function d(e){let{children:t,title:s,badge:a,className:l="",noPadding:n=!1}=e;return(0,r.jsxs)("div",{className:o()("bg-white rounded-lg shadow-sm border border-gray-100",{"p-6":!n,"mb-6":!l.includes("mb-"),"mb-8":s&&!l.includes("mb-")},l),children:[s&&(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:s}),a&&a]}),t]})}function m(e){let{serverInfo:t,healthStatus:s,metrics:a,uptimeSeconds:l}=e,n=(0,r.jsx)("div",{className:o()("px-3 py-1 rounded-full text-sm font-medium",{"bg-green-100 text-green-800":"healthy"===s,"bg-red-100 text-red-800":"error"===s,"bg-gray-100 text-gray-800":"loading"===s}),children:s});return(0,r.jsx)(d,{title:"Server Status & Metrics",badge:n,className:"p-8 mb-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:"Server Info"}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Version: "}),(0,r.jsx)("span",{className:c().className,children:t.version})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Server ID: "}),(0,r.jsx)("span",{className:o()(c().className,"text-sm"),children:t.uuid})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:"System Metrics"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Memory: "}),(0,r.jsx)("span",{className:c().className,children:function(e){if(void 0===e)return"-";let t=["B","KB","MB","GB","TB"],s=0,r=e;for(;r>=1024&&s<t.length-1;)r/=1024,s++;return"".concat(r.toFixed(1)," ").concat(t[s])}(a.residentMemoryBytes)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Uptime: "}),(0,r.jsx)("span",{className:c().className,children:function(e){if(void 0===e)return"-";let t=Math.floor(e/86400),s=Math.floor(e%86400/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60),l=[];return t>0&&l.push("".concat(t,"d")),s>0&&l.push("".concat(s,"h")),r>0&&l.push("".concat(r,"m")),l.push("".concat(a,"s")),l.join(" ")}(l)})]})]})]})})}function x(e){let{models:t,loading:s=!1,error:a}=e,l=(0,r.jsx)("div",{className:"bg-primary-100 text-primary-800 px-3 py-1 rounded-full text-sm font-medium",children:t.length});return(0,r.jsx)(d,{title:"Loaded Models",badge:l,children:(0,r.jsx)("div",{className:"space-y-2",children:s?(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading models..."}):a?(0,r.jsxs)("p",{className:"text-red-500 text-sm",children:["Error: ",a]}):0===t.length?(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"No models loaded"}):(0,r.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-2",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded p-4 text-sm",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 mb-1",children:e.model_id}),(0,r.jsxs)("div",{className:"text-gray-600",children:["Task: ",e.task_type," | Batch Size: ",e.batch_size]})]},t))})})})}function u(e){let{requestStats:t,loading:s=!1,error:a}=e;return(0,r.jsx)(d,{title:"Inference API Requests",children:(0,r.jsx)("div",{className:"space-y-3",children:s?(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Loading request statistics..."}):a?(0,r.jsxs)("p",{className:"text-red-500 text-sm",children:["Error: ",a]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Total: "}),(0,r.jsx)("span",{className:c().className,children:t.total.toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-700",children:"Success Rate: "}),(0,r.jsxs)("span",{className:o()(c().className,t.successRate>=95?"text-green-600":t.successRate>=90?"text-yellow-600":"text-red-600"),children:[t.successRate.toFixed(1),"%"]})]}),t.topEndpoints.length>0&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-3",children:"Top Endpoints:"}),(0,r.jsx)("div",{className:"space-y-2",children:t.topEndpoints.map((e,t)=>(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:c().className,children:e.endpoint}),(0,r.jsxs)("span",{className:"text-gray-500",children:["(",e.count,")"]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-600",children:["Success: ",e.successCount," | Errors: ",e.errorCount]}),(0,r.jsxs)("span",{className:o()("text-xs font-medium px-2 py-1 rounded",e.successRate>=95?"bg-green-100 text-green-700":e.successRate>=90?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.successRate.toFixed(1),"%"]})]})]},t))})]})]})})})}let h={DEBUG:"text-gray-600",INFO:"text-blue-600",WARNING:"text-yellow-600",ERROR:"text-red-600",CRITICAL:"text-red-800 font-bold"},f=["DEBUG","INFO","WARNING","ERROR","CRITICAL"];function g(e){var t;let{logs:s,loading:l,error:n}=e,[c,i]=(0,a.useState)(""),[o,m]=(0,a.useState)(""),[x,u]=(0,a.useState)(!0),g=(0,a.useRef)(null),p=(0,a.useRef)(s.length);(0,a.useEffect)(()=>{x&&s.length>p.current&&g.current&&(g.current.scrollTop=g.current.scrollHeight),p.current=s.length},[s,x]);let j=s.filter(e=>{let t=!c||e.level===c,s=!o||e.message.toLowerCase().includes(o.toLowerCase())||e.logger.toLowerCase().includes(o.toLowerCase());return t&&s}),y=e=>{try{return new Date(e).toLocaleTimeString()}catch(t){return e}};return l?(0,r.jsx)(d,{title:"Application Logs",children:(0,r.jsx)("div",{className:"text-gray-600",children:"Loading logs..."})}):n?(0,r.jsx)(d,{title:"Application Logs",children:(0,r.jsxs)("div",{className:"text-red-600",children:["Error loading logs: ",n]})}):(0,r.jsx)(d,{title:"Application Logs",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("label",{htmlFor:"log-level",className:"text-sm font-medium text-gray-700",children:"Level:"}),(0,r.jsxs)("select",{id:"log-level",value:c,onChange:e=>i(e.target.value),className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[(0,r.jsx)("option",{value:"",children:"All Levels"}),f.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 flex-1 max-w-xs",children:[(0,r.jsx)("label",{htmlFor:"log-search",className:"text-sm font-medium text-gray-700",children:"Search:"}),(0,r.jsx)("input",{id:"log-search",type:"text",value:o,onChange:e=>m(e.target.value),placeholder:"Filter logs...",className:"border border-gray-300 rounded px-2 py-1 text-sm flex-1"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{id:"auto-scroll",type:"checkbox",checked:x,onChange:e=>u(e.target.checked),className:"rounded"}),(0,r.jsx)("label",{htmlFor:"auto-scroll",className:"text-sm font-medium text-gray-700",children:"Auto-scroll"})]})]}),(0,r.jsx)("div",{ref:g,className:"bg-black text-green-400 p-4 rounded-lg font-mono text-xs overflow-y-auto h-96",style:{fontFamily:'Monaco, "Lucida Console", monospace'},children:0===j.length?(0,r.jsx)("div",{className:"text-gray-500",children:0===s.length?"No logs available":"No logs match the current filters"}):j.map((e,t)=>(0,r.jsxs)("div",{className:"mb-1 break-words",children:[(0,r.jsxs)("span",{className:"text-gray-400",children:["[",y(e.timestamp),"]"]})," ",(0,r.jsx)("span",{className:"font-semibold ".concat(h[e.level]||"text-gray-400"),children:e.level})," ",(0,r.jsxs)("span",{className:"text-cyan-400",children:[e.logger,":"]})," ",(0,r.jsx)("span",{className:"text-green-400",children:e.message})]},t))}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 flex justify-between",children:[(0,r.jsxs)("span",{children:["Showing ",j.length," of ",s.length," log entries"]}),s.length>0&&(0,r.jsxs)("span",{children:["Latest: ",y(null==(t=s[s.length-1])?void 0:t.timestamp)]})]})]})})}function p(e){let{onRefresh:t}=e;return(0,r.jsx)(d,{children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsx)("a",{href:"/",className:"inline-flex items-center px-4 py-2 rounded-md bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 hover:border-gray-400 transition-colors shadow-sm",children:"Home"}),(0,r.jsx)("button",{onClick:t,className:"inline-flex items-center px-4 py-2 rounded-md bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 hover:border-gray-400 transition-colors shadow-sm",children:"Refresh Data"})]})})}function j(e){let{errors:t}=e;return 0===t.length?null:(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-800 text-sm",children:t.join(" â€¢ ")})})}function y(){return(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:[(0,r.jsx)("span",{className:"text-primary-700",children:"Inference"})," Dashboard"]}),(0,r.jsx)("p",{className:"text-gray-600",children:"Here are your Roboflow Inference server status and metrics"})]})}function N(){let e=function(){let[e,t]=(0,a.useState)(null),[s,r]=(0,a.useState)(!0),[l,n]=(0,a.useState)(null),c=(0,a.useCallback)(async()=>{try{n(null);let e=await fetch("/info");if(e.ok){let s=await e.json();t(s)}else n("Failed to fetch server info (".concat(e.status,")"))}catch(e){n("Server connection failed"),console.error("Failed to fetch server info:",e)}finally{r(!1)}},[]);return(0,a.useEffect)(()=>{c()},[c]),{serverInfo:e,healthStatus:l?"error":e?"healthy":"loading",loading:s,error:l,refetch:c}}(),t=function(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[l,n]=(0,a.useState)(null),c=(0,a.useCallback)(async()=>{try{n(null);let e=await fetch("/model/registry");if(e.ok){let s=await e.json();t(s.models||[])}else n("Failed to fetch models (".concat(e.status,")"))}catch(e){n("Failed to connect to models endpoint"),console.error("Failed to fetch models:",e)}finally{r(!1)}},[]);return(0,a.useEffect)(()=>{c()},[c]),{models:e,loading:s,error:l,refetch:c}}(),s=function(){let[e,t]=(0,a.useState)({}),[s,r]=(0,a.useState)({total:0,successRate:100,topEndpoints:[]}),[n,c]=(0,a.useState)(!0),[i,o]=(0,a.useState)(null),d=(0,a.useCallback)(async()=>{try{o(null);let e=await fetch("/metrics");if(e.ok){let s=await e.text(),a=function(e){let t=e.split(/\n/),s={},r={},a={},n={},c=0,i=0;for(let e of t)if(!(!e||e.startsWith("#"))){if(e.startsWith("process_resident_memory_bytes")){let t=Number(e.split(/\s+/).pop());Number.isNaN(t)||(s.residentMemoryBytes=t)}else if(e.startsWith("process_start_time_seconds")){let t=Number(e.split(/\s+/).pop());Number.isNaN(t)||(s.startTimeSeconds=t)}else if(e.startsWith("http_requests_total")){let t=e.match(/handler="([^"]+)".*status="(\d)xx".*\s+(\d+(?:\.\d+)?)/);if(t){let[,e,s,o]=t,d=parseFloat(o);l.some(t=>e.startsWith(t)||e.includes(t))&&"none"!==e&&(r[e]=(r[e]||0)+d,"2"===s?(a[e]=(a[e]||0)+d,i+=d):("4"===s||"5"===s)&&(n[e]=(n[e]||0)+d),c+=d)}}}let o=Object.entries(r).sort((e,t)=>{let[,s]=e,[,r]=t;return r-s}).slice(0,5).map(e=>{let[t,s]=e,r=a[t]||0,l=n[t]||0;return{endpoint:t,count:s,successRate:s>0?r/s*100:100,successCount:r,errorCount:l}}),d=c>0?i/c*100:100;return{metrics:s,requests:{total:c,successRate:d,topEndpoints:o}}}(s);t(a.metrics),r(a.requests)}else o("Failed to fetch metrics (".concat(e.status,")"))}catch(e){o("Failed to connect to metrics endpoint"),console.error("Failed to fetch metrics:",e)}finally{c(!1)}},[]);return(0,a.useEffect)(()=>{d()},[d]),{metrics:e,requestStats:s,loading:n,error:i,refetch:d}}(),n=function(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[l,n]=(0,a.useState)(null),[c,i]=(0,a.useState)(!1),o=(0,a.useCallback)(async()=>{try{n(null);let e=await fetch("/logs?limit=200");if(404===e.status)i(!1),t([]);else if(e.ok){let s=await e.json();t(s.logs),i(!0)}else n("Failed to fetch logs (".concat(e.status,")")),i(!1)}catch(e){i(!1),t([]),console.error("Failed to fetch logs:",e)}finally{r(!1)}},[]);return(0,a.useEffect)(()=>{o()},[o]),{logs:e,loading:s,error:l,logsAvailable:c,refetch:o}}(),c=(0,a.useCallback)(()=>{e.refetch(),t.refetch(),s.refetch(),n.logsAvailable&&n.refetch()},[e.refetch,t.refetch,s.refetch,n.refetch,n.logsAvailable]);!function(e){let{interval:t=5e3,enabled:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,a.useRef)(e);(0,a.useEffect)(()=>{r.current=e},[e]),(0,a.useEffect)(()=>{if(!s)return;let e=setInterval(()=>{r.current()},t);return()=>clearInterval(e)},[t,s])}(c,{interval:5e3});let i=[...e.error?[e.error]:[],...t.error?[t.error]:[],...s.error?[s.error]:[],...n.error?[n.error]:[]],o=e.loading||t.loading||s.loading,d=s.metrics.startTimeSeconds?Math.max(0,Date.now()/1e3-s.metrics.startTimeSeconds):void 0;return o?(0,r.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-8",children:(0,r.jsx)("div",{className:"text-xl",children:"Loading dashboard..."})}):(0,r.jsx)("main",{className:"flex min-h-screen flex-col p-8 bg-gradient-to-br from-gray-50 to-primary-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto w-full",children:[(0,r.jsx)(y,{}),(0,r.jsx)(j,{errors:i}),(0,r.jsx)(p,{onRefresh:c}),(0,r.jsx)(m,{serverInfo:e.serverInfo,healthStatus:e.healthStatus,metrics:s.metrics,uptimeSeconds:d}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsx)(x,{models:t.models,loading:t.loading,error:t.error}),(0,r.jsx)(u,{requestStats:s.requestStats,loading:s.loading,error:s.error})]}),n.logsAvailable&&(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(g,{logs:n.logs,loading:n.loading,error:n.error})})]})})}},5737:(e,t,s)=>{Promise.resolve().then(s.bind(s,5208))},5803:e=>{e.exports={style:{fontFamily:"'Roboto Mono', 'Roboto Mono Fallback'",fontStyle:"normal"},className:"__className_5899e0"}},9300:(e,t)=>{var s;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var s=arguments[t];s&&(e=l(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var s in e)r.call(e,s)&&e[s]&&(t=l(t,s));return t}(s)))}return e}function l(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(s=(function(){return a}).apply(t,[]))||(e.exports=s)}()}},e=>{var t=t=>e(e.s=t);e.O(0,[158,441,684,358],()=>t(5737)),_N_E=e.O()}]);